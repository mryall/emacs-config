
* Org-Mode Configuration                                              :TOC_3:
    - [[#list-setup][List Setup]]
    - [[#behaviours][Behaviours]]
    - [[#keybindings][Keybindings]]
    - [[#fix-conflicts-and-disputed-keys][Fix Conflicts and Disputed Keys]]
    - [[#org-agenda][Org-Agenda]]
    - [[#hooks][Hooks]]
    - [[#org-babel][Org-Babel]]
    - [[#generate-table-of-contents][Generate Table of Contents]]
    - [[#habits][Habits]]
    - [[#clocks][Clocks]]
    - [[#exports][Exports]]

*** List Setup
    Extend the sub-items bullet count by two (1,3,5 characters etc.) to give a
    more pronounced tree and make bulleted sub-items appear to be indented
    #+BEGIN_SRC emacs-lisp

      (setq-default org-odd-levels-only t)
      (setq-default org-hide-leading-stars t)

    #+END_SRC

*** Behaviours
    Ensure keyboard navigation works sensibly in headings and when tags are in
    place on an item
    #+begin_src emacs-lisp

      (setq-default org-return-follows-link t)
      (setq-default org-special-ctrl-a/e t)
      (setq-default org-special-ctrl-k t)
      (setq-default org-insert-heading-respect-content t)

    #+end_src

*** Keybindings
    #+BEGIN_SRC emacs-lisp

      (define-key global-map "\C-ca" 'org-agenda)

    #+END_SRC

*** Fix Conflicts and Disputed Keys
    #+BEGIN_SRC emacs-lisp

    ;; Make windmove work in Org mode:
    (add-hook 'org-shiftup-final-hook 'windmove-up)
    (add-hook 'org-shiftleft-final-hook 'windmove-left)
    (add-hook 'org-shiftdown-final-hook 'windmove-down)
    (add-hook 'org-shiftright-final-hook 'windmove-right)

    (setq-default org-replace-disputed-keys t)
    (setq-default org-support-shift-select 'always)

    #+END_SRC

*** Org-Agenda
    #+BEGIN_SRC emacs-lisp

      (setq-default org-agenda-files '("~/Library/Mobile Documents/iCloud~com~appsonthemove~beorg/Documents/org"))

    #+END_SRC

*** Hooks
    As we loaded org-mode in the initial bootstrap .emacs file we add hooks
    here instead of in the use-package definition
    #+begin_src emacs-lisp

    (add-hook 'org-mode-hook
              '(lambda ()
                 (turn-on-flyspell)
                 (auto-fill-mode t)))
    #+end_src

    Add a before-save-hook that's specific to org-mode files
    #+begin_src emacs-lisp

    (defun mjr-org-mode-before-save-hook ()
      (when (eq major-mode 'org-mode)
        (mjr/insert-literate-config-file-list)))

    (add-hook 'before-save-hook #'mjr-org-mode-before-save-hook)
    #+end_src

*** Org-Babel
    #+begin_src emacs-lisp

    (setq-default org-src-tab-acts-natively t)
    (setq-default org-edit-src-content-indentation 0)
    (setq-default org-src-window-setup 'current-window)
    (setq-default org-edit-src-persistent-message nil)

    (org-babel-do-load-languages 'org-babel-load-languages
                                 '((shell . t)))

    (define-advice org-edit-src-exit (:before (&rest _args))
      (delete-trailing-whitespace))
    #+end_src

*** Generate Table of Contents
    Automatically generates a table of contents for an org buffer based on the
    headings within. The TOC is regenerated on buffer save and placed under a
    heading with the tag :TOC:
    #+begin_src emacs-lisp

      (use-package toc-org
        :ensure t
        :hook (org-mode . toc-org-mode)
        :after org)

    #+end_src

*** Habits
    #+begin_src emacs-lisp

    (use-package org-habit)
    (setq-default org-log-into-drawer t)
    (setq-default org-todo-keywords '("TODO" "DONE(!)"))
    #+end_src
*** Clocks
    #+begin_src emacs-lisp
    (setq org-duration-format (quote h:mm))
    #+end_src
*** Exports
    #+begin_src emacs-lisp

    (use-package ox-hugo
      :ensure t
      :after ox)

    #+end_src
